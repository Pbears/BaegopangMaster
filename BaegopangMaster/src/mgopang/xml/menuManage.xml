<?xml version="1.0" encoding="EUC-KR"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mgopang.xml.menuManage"> 
	<select id="selectMenu" parameterType="java.lang.String" resultType="menu">
  			  select r.rank,address,point from(   
  					select dense_rank() over(order by m.point desc)rank, m.address,m.point
					from(	
						select SUBSTR(storename,1,INSTR(storename,'-')-1)store, point
						from master
  					    where storename=#{storename}
 				     )sear, master m
					where SUBSTR(storename,1,INSTR(storename,'-')-1)=store)r
   			   where rank BETWEEN 1 and 5;
	</select>  
	
	<select id="myStoreMenu" parameterType="java.lang.String" resultType="menu">
		    select menuname,price,picture 
  			from menu
  			where 
   			menuname in (SELECT MENUNAME FROM MENUBYSTORE WHERE storename=#{storename})
	</select>
	
	<insert id="insertMenu" parameterType="java.util.HashMap">
		INSERT INTO MENUBYSTORE values(MBS_SEQ.NEXTVAL,#{menuname},#{storename})
	</insert>
	<delete id="deleteMenu" parameterType="java.lang.String">
		delete MENUBYSTORE where menuname=#{menuname}
	</delete>
</mapper>